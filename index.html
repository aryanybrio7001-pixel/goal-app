<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ultimate Goal App</title>
<link rel="manifest" href="manifest.json">
<style>
:root {
  --bg:#0b1020; --card:#111827; --border:#1f2937;
  --accent:#22c55e; --danger:#ef4444; --text:#e5e7eb; --muted:#9ca3af;
}
.light {
  --bg:#f4f6fb; --card:#fff; --border:#e5e7eb;
  --text:#020617; --muted:#6b7280;
}
*{box-sizing:border-box;font-family:Inter,system-ui}
body{margin:0;background:var(--bg);color:var(--text);padding:16px}
.container{max-width:950px;margin:auto}
header{display:flex;justify-content:space-between;align-items:center}
.card{background:var(--card);border:1px solid var(--border);
  border-radius:18px;padding:16px;margin-top:14px}
input,textarea,select{
  width:100%;padding:10px;border-radius:12px;
  border:1px solid var(--border);background:transparent;color:var(--text)
}
button{
  background:var(--accent);border:none;padding:10px 14px;
  border-radius:12px;font-weight:600;cursor:pointer
}
.row{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px}
.goal{border:1px solid var(--border);border-radius:16px;padding:14px;margin-top:12px}
.progress{height:8px;background:#1f2937;border-radius:999px;overflow:hidden}
.progress div{height:100%;background:var(--accent)}
.meta{display:flex;justify-content:space-between;font-size:13px;color:var(--muted)}
.badge{font-size:12px;padding:4px 8px;border-radius:999px}
.high{background:#dc2626}.medium{background:#f59e0b}.low{background:#16a34a}
.overdue{color:var(--danger)} .done{color:var(--accent)}
canvas{width:100%;height:200px}
</style>
</head>

<body>
<div class="container">

<header>
  <h1>üî• Ultimate Goal App</h1>
  <button onclick="toggleTheme()">üåó</button>
</header>

<div class="card">
  <strong>üèÜ Level <span id="level">1</span> ‚Ä¢ XP <span id="xp">0</span></strong>
  <p>üî• Streak: <span id="streak">0</span> days</p>
</div>

<div class="card">
  <input id="title" placeholder="Goal title">
  <textarea id="desc" placeholder="Description"></textarea>
  <div class="row">
    <select id="category">
      <option>Work</option><option>Study</option>
      <option>Health</option><option>Personal</option>
    </select>
    <select id="priority">
      <option value="low">Low</option>
      <option value="medium">Medium</option>
      <option value="high">High</option>
    </select>
    <input type="date" id="date">
  </div>
  <button onclick="addGoal()">Add Goal üöÄ</button>
</div>

<div class="card">
  <strong>üìä Productivity Analytics</strong>
  <canvas id="chart"></canvas>
</div>

<div class="card">
  <strong>üóì Upcoming Deadlines</strong>
  <ul id="calendar"></ul>
</div>

<div id="goals"></div>

</div>

<script>
let data = JSON.parse(localStorage.getItem("data")) || {
  goals:[], xp:0, streak:0, lastDay:null, theme:"dark"
};
if(data.theme==="light") document.body.classList.add("light");

function save(){localStorage.setItem("data",JSON.stringify(data))}

function toggleTheme(){
  document.body.classList.toggle("light");
  data.theme=document.body.classList.contains("light")?"light":"dark";
  save();
}

function addGoal(){
  if(!title.value) return;
  data.goals.push({
    title:title.value,desc:desc.value,
    category:category.value,priority:priority.value,
    date:date.value,progress:0,created:Date.now()
  });
  title.value=desc.value="";
  notify("New goal added!");
  save(); render();
}

function updateProgress(i,v){
  let g=data.goals[i];
  if(g.progress<100 && v>=100){ gainXP(50); }
  g.progress=v; save(); render();
}

function gainXP(x){
  data.xp+=x;
  save();
}

function checkStreak(){
  const today=new Date().toDateString();
  if(data.lastDay!==today){
    data.streak++;
    data.lastDay=today;
    gainXP(10);
  }
}

function notify(msg){
  if(Notification.permission==="granted"){
    new Notification("Goal App",{body:msg});
  }
}

function render(){
  checkStreak();
  xp.innerText=data.xp;
  level.innerText=Math.floor(data.xp/100)+1;
  streak.innerText=data.streak;

  goals.innerHTML="";
  calendar.innerHTML="";
  let completed=0;

  data.goals.forEach((g,i)=>{
    if(g.progress>=100) completed++;
    const overdue=g.date && new Date(g.date)<new Date() && g.progress<100;
    if(g.date && g.progress<100){
      calendar.innerHTML+=`<li>${g.title} ‚Äì ${g.date}</li>`;
    }
    goals.innerHTML+=`
      <div class="goal">
        <strong>${g.title}</strong>
        <span class="badge ${g.priority}">${g.priority}</span>
        <p>${g.desc}</p>
        <div class="progress"><div style="width:${g.progress}%"></div></div>
        <input type="range" min="0" max="100" value="${g.progress}"
          oninput="updateProgress(${i},this.value)">
        <div class="meta">
          <span>${g.category}</span>
          <span class="${g.progress>=100?'done':overdue?'overdue':''}">
            ${g.progress>=100?'‚úÖ Done':overdue?'‚è∞ Overdue':'‚è≥ Active'}
          </span>
        </div>
      </div>`;
  });

  drawChart(completed, data.goals.length-completed);
}

function drawChart(done,active){
  const c=document.getElementById("chart");
  const ctx=c.getContext("2d");
  ctx.clearRect(0,0,c.width,c.height);
  const total=done+active||1;
  ctx.fillStyle="#22c55e";
  ctx.fillRect(0,0,(done/total)*c.width,40);
  ctx.fillStyle="#ef4444";
  ctx.fillRect((done/total)*c.width,0,(active/total)*c.width,40);
}

if(Notification.permission!=="granted"){
  Notification.requestPermission();
}

render();
</script>
</body>
</html>